<script>
  import { applyTheme } from '~/panda/theme'
  import { getThemeByPreferColorScheme } from '~/utils/theme'

  function updateTheme() {
    const targetElement = document.body
    const theme = getThemeByPreferColorScheme()
    applyTheme(targetElement, theme)
  }

  function initTheme() {
    updateTheme()

    const colorSchemeMediaQuery = window.matchMedia(
      '(prefers-color-scheme: dark)'
    )
    colorSchemeMediaQuery.addEventListener('change', updateTheme)
  }

  initTheme()
</script>
